#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#define BUFSIZ 21

int main()
{
  FILE *lecture_flux;
  char buffer[BUFSIZ + 1];
  int nbread;
  /* memset(buffer, '\0', sizeof(buffer)); */
  lecture_flux = popen("uname -a", "r");
  if (lecture_flux != NULL) {
    printf("La sortie du programme etait:\n");
    while ((nbread = fread(buffer, sizeof(char), BUFSIZ, lecture_flux)) > 0) {
      buffer[sizeof(char) * nbread]= '\0';
      printf("%s", buffer);
      /* memset(buffer, '\0', sizeof(buffer)); */
    }
    pclose(lecture_flux);
    printf("\n");
    exit(EXIT_SUCCESS);
  }
  exit(EXIT_FAILURE);
}
