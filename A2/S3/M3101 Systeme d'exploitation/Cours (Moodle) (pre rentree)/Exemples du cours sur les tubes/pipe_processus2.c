#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#define BUFSIZ 100
int main() {
  FILE *read_flux;
  char buffer[BUFSIZ + 1];
  int chars_read;
  memset(buffer,'\0', sizeof(buffer));
  read_flux = popen("ps ax", "r");
  if (read_flux != NULL) {
    chars_read = fread(buffer, sizeof(char), BUFSIZ, read_flux);
    while (chars_read > 0) {
      buffer[chars_read]= '\0';
      printf("Lecture de: %s\n", buffer);
      chars_read = fread(buffer, sizeof(char), BUFSIZ, read_flux);
    }
    pclose(read_flux);
    exit(EXIT_SUCCESS);
  }
  exit(EXIT_FAILURE);
}
