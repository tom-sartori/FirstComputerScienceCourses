#include "../commun/td3.h"
#include "../commun/palette.c"


extern Handler HANDLER_TABLE[PALETTE_SIZE];
extern char ALPHABET_PALETTE[PALETTE_SIZE];
extern char* NOM_FICHIERS[PALETTE_SIZE];

//choix de la palette a utiliser
char* palette_courante = ALPHABET_PALETTE;

char minuscule(char c); 
char* getIndex (int n); 

void codage(int in) {
	char c;  
	int nbLus = -1; 
	int desc;
	int index = 0;    

	while (nbLus != 0) {		
		nbLus = read(in, &c, 1); 
		desc = open(get_filename_for_char(minuscule(c)), O_CREAT | O_WRONLY, 0777); 
		
		write(desc, getIndex(1), 7);
		index++;
	}

	
	//int *index = malloc(sizeof(int)); 
	//*index = lseek(in, SEEK_CUR, 0); 
	
	

}

char minuscule(char c) {
	if (97 <= c && c <= 122)
		return c; 
	else if (65 <= c && c <= 90)
		return 97 + c%65; 
}

char* getIndex (int n) {
	char tab [8] = "00000000"; 
	if (n < 10) {
		tab[7] = n; 
		return "000000" + "10"; 
	}
	return "abc"; 
}


int main() {
	int fd = open("./message.txt", O_RDONLY); 
	codage(fd); 
	printf("test \n");
}



void decodage(int out)
{


}
