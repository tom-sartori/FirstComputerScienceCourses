#include "../commun/td3.h"


extern Handler HANDLER_TABLE[PALETTE_SIZE];
extern char ALPHABET_PALETTE[PALETTE_SIZE];
extern char* NOM_FICHIERS[PALETTE_SIZE];

//choix de la palette a utiliser
char* palette_courante = ALPHABET_PALETTE;
void codage(int in); 
char minuscule(char c); 
void decodage(int out); 


void codage(int in) {
	unsigned char c;  
	//int nbLus = -1; 
	int desc;
	unsigned char index = 0;    
	int nbLus = read(in, &c, 1); 
	while (nbLus != 0) {		
		
		if (desc = open(get_filename_for_char(minuscule(c)), O_RDONLY) == -1) { // check juste wr
			desc = open(get_filename_for_char(minuscule(c)), O_CREAT | O_WRONLY, 0666);
		}
		else {
			close(desc); 
			desc = open(get_filename_for_char(minuscule(c)), O_APPEND | O_RDWR); // check juste wr
		}
		
		write(desc, &index, 1);
		close(desc); 
		index++;
		nbLus = read(in, &c, 1); 
	}
	close (in); 
}

char minuscule(char c) {
	if (97 <= c && c <= 122)
		return c; 
	else if (65 <= c && c <= 90)
		return 97 + c%65; 
	return c;
}


void decodage(int out) {
	/*
		- ls de *.in dan sun fichier 
		- Pour chaque nom dans le fichier du ls 
			- Ouvrir le fichier correspondant 
			- Faire pour chaque nb du fichier 
				- lseek du nb dans le fichier out en param
				- Ecrire le caractere du nom du fichier 
			- close le fichier
			- Aller au fichier d'apres dans la liste de ls
		- close 
	*/



}
